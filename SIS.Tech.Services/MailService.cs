using SIS.Tech.IServices;
using SIS.Tech.Util;
using SISFramework.Parameter.DerivedParameter;
using System.Net;
using System.Net.Mail;
using System.Text;

namespace SIS.Tech.Services
{
    public class MailService : IMailService
    {
        public void receiveMail()
        {

        }

        public void sendMail(string mailFrom, string mailTo, string subject, string tipo, string codForamtado, string nomeUsuario, string senhaCryptoNew, string nomeLogin)
        {
            MailMessage emailMessage = new MailMessage();

            try
            {
                var host = new LocalMachine().LerParametro("SINDPETSHOP", "ConfiguracoesSMTP", "HOST").Valor;
                var port = new LocalMachine().LerParametro("SINDPETSHOP", "ConfiguracoesSMTP", "PORT").Valor;
                
                var userMail = new LocalMachine().LerParametro("SINDPETSHOP", "ConfiguracoesSMTP", "USERMAIL").Valor;
                var passwordMail = new LocalMachine().LerParametro("SINDPETSHOP", "ConfiguracoesSMTP", "PASSWORDMAIL").Valor;
                var passwordToSteps = new LocalMachine().LerParametro("SINDPETSHOP", "ConfiguracoesSMTP", "PASSWORDTOSTEPS").Valor;
                
                var smtpClient = new SmtpClient(host, Convert.ToInt32(port));

                smtpClient.EnableSsl = true;
                //smtpClient.Timeout = 60 * 60;
                smtpClient.UseDefaultCredentials = false;
                smtpClient.Credentials = new NetworkCredential(userMail, passwordMail);

                emailMessage.From = new MailAddress(mailFrom, " Sindpetshop-SP");

                if (tipo == "bodyForgotPassword")
                    emailMessage.Body = bodyForgotPassword(mailFrom, mailTo, subject, codForamtado, nomeUsuario);
                if (tipo == "bodyConfirmForgotPassword")
                    emailMessage.Body = bodyConfirmForgotPassword(mailFrom, mailTo, subject, codForamtado, nomeUsuario, senhaCryptoNew);
                if (tipo == "bodyLoginBloqueado")
                    emailMessage.Body = bodyLoginBloeqado(mailFrom, mailTo, subject, codForamtado, nomeUsuario, nomeLogin);

                emailMessage.Subject = subject;
                emailMessage.IsBodyHtml = true;
                emailMessage.Priority = MailPriority.Normal;
                emailMessage.To.Add(mailTo);

                smtpClient.Send(emailMessage);
            }
            catch (Exception ex)
            {
                throw;
            }
        }

        public string bodyForgotPassword(string mailFrom, string mailTo, string subject, string codForamtado, string nomeUsuario)
        {
            string body = string.Empty;

            var emailSuporte = new LocalMachine().LerParametro("SINDPETSHOP", "Configuracoes", "EmailSuporte").Valor;
            var linkSiteInstitucional = new LocalMachine().LerParametro("SINDPETSHOP", "Configuracoes", "LinkSiteInstitucional").Valor;
            var linkLogoSindicato = new LocalMachine().LerParametro("SINDPETSHOP", "Configuracoes", "LinkLogoSindicato").Valor;
            var linkTwoStepsCover = new LocalMachine().LerParametro("SINDPETSHOP", "ConfiguracaoRotas", "LinkTwoStepsCover").Valor;
            
            StringBuilder sb = new StringBuilder();

            sb.Append("<!DOCTYPE html>                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.Append("<html>                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.Append("<head>                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.Append("    <meta charset='utf-8'>                                                                                                                                                                                                                                                                                                                                                                ");
            sb.Append("    <title>Redefinir a sua senha</title>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("    <link href='https://fonts.googleapis.com/css?family=Montserrat:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700' rel='stylesheet' media='screen'>                                                                                                                                                                                        ");
            sb.Append("    <style>                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.Append("        .hover-underline:hover {                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("            text-decoration: underline !important;                                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("        @media (max-width: 600px) {                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("            .sm-w-full                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        {                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("            width: 100% !important;                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        .sm-px-24 {                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("            padding-left: 24px !important;                                                                                                                                                                                                                                                                                                                                                ");
            sb.Append("            padding-right: 24px !important;                                                                                                                                                                                                                                                                                                                                               ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        .sm-py-32 {                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("            padding-top: 32px !important;                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("            padding-bottom: 32px !important;                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        }</style>                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("</head>                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("<body style='margin: 0; width: 100%; padding: 0; word-break: break-word; -webkit-font-smoothing: antialiased; background-color: #eceff1;'>                                                                                                                                                                                                                                                ");
            sb.Append("    <div role='article' aria-roledescription='email' aria-label='Reset your Password' lang='en' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly;'>                                                                                                                                                                                                            ");
            sb.Append("        <table style='width: 100%; font-family: Montserrat, -apple-system, 'Segoe UI', sans-serif;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                  ");
            sb.Append("            <tr>                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                <td align='center' style='mso-line-height-rule: exactly; background-color: #eceff1; font-family: Montserrat, -apple-system, 'Segoe UI', sans-serif;'>                                                                                                                                                                                                                   ");
            sb.Append("                    <table class='sm-w-full' style='width: 600px;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                   ");
            sb.Append("                        <tr>                                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                            <td class='sm-py-32 sm-px-24' style='padding: 48px;'>                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                            </td>                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                        </tr>                                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                        <tr>                                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                            <td align='center' class='sm-px-24' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly;'>                                                                                                                                                                                                                                            ");
            sb.Append("                                <table style='width: 100%;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                          ");
            sb.Append("                                    <tr>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("                                        <td class='sm-px-24' style='border-top-right-radius: 20px; background-color: #ffffff; padding-top: 20px; padding-bottom: 20px; border-top-left-radius: 20px;'>                                                                                                                                                                                  ");
            sb.Append("                                            <div style='text-align:center;'>                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                <a href='" + linkSiteInstitucional + "' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly;'>                                                                                                                                                                                                                      ");
            sb.Append("                                                    <img src='" + linkLogoSindicato + "' width='150' alt='Sindpetshop-SP' style='max-width: 100%; vertical-align: middle; line-height: 100%; border: 0;'>                                                                                                                               ");
            sb.Append("                                                </a>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                            </div>                                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                        </td>                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                    </tr>                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                    <tr>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("                                        <td class='sm-px-24' style='mso-line-height-rule: exactly;  background-color: #ffffff;  padding: 0px 40px 40px 40px; text-align: left; line-height: 24px; color: #626262; border-bottom-right-radius: 20px;  border-bottom-left-radius: 20px;'>                                                                                               ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin-bottom: 0; font-size: 20px; font-weight: 600;'>                                                                                                                                                                                                        ");
            sb.Append("                                                Olá                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin-top: 0; font-size: 24px; font-weight: 700; color: #e58334;'>                                                                                                                                                                                           ");
            sb.Append(nomeUsuario);
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0; margin-bottom: 24px;'>                                                                                                                                                                                                                             ");
            sb.Append("                                                Uma solicitação para redefinir a senha foi recebida de você                                                                                                                                                                                                                                                                               ");
            sb.Append("                                                <span style='font-weight: 600;'>                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                                    Sindpetshop-SP                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                </span> Conta -                                                                                                                                                                                                                                                                                                                           ");
            sb.Append("                                                <span style='font-weight: 600;'>                                                                                                                                                                                                                                                                                                          ");
            sb.Append(mailTo);
            sb.Append("                                                </span>                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("                                                do                                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                <span style='font-weight: 700; color: #e58334;'>                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                    SIS.Tech.                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                                </span>                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <table align='center' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                    ");
            sb.Append("                                                <tr>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                                    <td style='font-size: 24px; font-weight: 700; color: #e58334; font-family: Montserrat, -apple-system, 'Segoe UI', sans-serif;'>                                                                                                                                                                                                     ");
            sb.Append(codForamtado);            
            sb.Append("                                                    </td>                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                </tr>                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("                                            </table>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                            </br>                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0; margin-bottom: 24px;'>                                                                                                                                                                                                                             ");
            sb.Append("                                                Clique no botão abaixo, para redefinir sua senha e fazer login.                                                                                                                                                                                                                                                                           ");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <table align='center' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                    ");
            sb.Append("                                                <tr>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                                    <td style='height: 30px; border-radius: 4px;'>                                                                                                                                                                             ");
            sb.Append("                                                        <a href='" + linkTwoStepsCover + "' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; display: block; padding-left: 24px!important; padding-right: 24px!important; padding-top: 16px!important; padding-bottom: 16px!important; font-size: 24px!important; font-weight: 600!important; line-height: 100%; text-decoration: none!important;'>");
            sb.Append("                                                            Redefinir senha &rarr;                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                        </a>                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                    </td>                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                </tr>                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("                                            </table>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                            </br>                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0; margin-top: 24px; margin-bottom: 24px;'>                                                                                                                                                                                                           ");
            sb.Append("                                                <span style='font-weight: 600;'>Note:</span>                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                Este link é válido por 1 hora a partir do momento em que foi                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                enviado à você e pode ser usado para alterar sua senha apenas uma vez.                                                                                                                                                                                                                                                                    ");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <table style='width: 100%;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                              ");
            sb.Append("                                                <tr>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                                    <td style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; padding-top: 32px; padding-bottom: 12px;'>                                                                                                                                                                                                           ");
            sb.Append("                                                        <div style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; height: 1px; background-color: #eceff1; line-height: 1px;'>&zwnj;</div>                                                                                                                                                                         ");
            sb.Append("                                                        </br>                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                                        <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0;'>                                                                                                                                                                                                                                      ");
            sb.Append("                                                            Caso tenha alguma dificuldade, solicite a nossa ajuda!                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                        </p>                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                        <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0;'>                                                                                                                                                                                                                                      ");
            sb.Append("                                                            Entre em contato conosco em                                                                                                                                                                                                                                                                                                   ");
            sb.Append("                                                            <a href=' "+ emailSuporte + "' class='hover-underline' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; color: #000; text-decoration: none;'>                                                                                                                                    ");
            sb.Append("                                                                suporte@sindpetshop.org.com                                                                                                                                                                                                                                                                                               ");
            sb.Append("                                                            </a>                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                                        </p>                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                    </td>                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                </tr>                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("                                            </table>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                        </td>                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                    </tr>                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                </table>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("                            </td>                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                        </tr>                                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                    </table>                                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                </td>                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("            </tr>                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("        </table>                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("    </div>                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.Append("</br>");
            sb.Append("</br>");
            sb.Append("</body>                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("</html>                                                                                                                                                                                                                                                                                                                                                                                   ");


            body = sb.ToString();

            return body;

        }

        public string bodyConfirmForgotPassword(string mailFrom, string mailTo, string subject, string codForamtado, string nomeUsuario, string senhaCryptoNew)
        {
            string body = string.Empty;

            var emailSuporte = new LocalMachine().LerParametro("SINDPETSHOP", "Configuracoes", "EmailSuporte").Valor;
            var linkSiteInstitucional = new LocalMachine().LerParametro("SINDPETSHOP", "Configuracoes", "LinkSiteInstitucional").Valor;
            var linkLogoSindicato = new LocalMachine().LerParametro("SINDPETSHOP", "Configuracoes", "LinkLogoSindicato").Valor;
            var linkTwoStepsCover = new LocalMachine().LerParametro("SINDPETSHOP", "ConfiguracaoRotas", "LinkTwoStepsCover").Valor;

            StringBuilder sb = new StringBuilder();

            sb.Append("<!DOCTYPE html>                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.Append("<html>                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.Append("<head>                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.Append("    <meta charset='utf-8'>                                                                                                                                                                                                                                                                                                                                                                ");
            sb.Append("    <title>Redefinir a sua senha</title>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("    <link href='https://fonts.googleapis.com/css?family=Montserrat:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700' rel='stylesheet' media='screen'>                                                                                                                                                                                        ");
            sb.Append("    <style>                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.Append("        .hover-underline:hover {                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("            text-decoration: underline !important;                                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("        @media (max-width: 600px) {                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("            .sm-w-full                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        {                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("            width: 100% !important;                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        .sm-px-24 {                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("            padding-left: 24px !important;                                                                                                                                                                                                                                                                                                                                                ");
            sb.Append("            padding-right: 24px !important;                                                                                                                                                                                                                                                                                                                                               ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        .sm-py-32 {                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("            padding-top: 32px !important;                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("            padding-bottom: 32px !important;                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        }</style>                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("</head>                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("<body style='margin: 0; width: 100%; padding: 0; word-break: break-word; -webkit-font-smoothing: antialiased; background-color: #eceff1;'>                                                                                                                                                                                                                                                ");
            sb.Append("    <div role='article' aria-roledescription='email' aria-label='Reset your Password' lang='en' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly;'>                                                                                                                                                                                                            ");
            sb.Append("        <table style='width: 100%; font-family: Montserrat, -apple-system, 'Segoe UI', sans-serif;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                  ");
            sb.Append("            <tr>                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                <td align='center' style='mso-line-height-rule: exactly; background-color: #eceff1; font-family: Montserrat, -apple-system, 'Segoe UI', sans-serif;'>                                                                                                                                                                                                                   ");
            sb.Append("                    <table class='sm-w-full' style='width: 600px;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                   ");
            sb.Append("                        <tr>                                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                            <td class='sm-py-32 sm-px-24' style='padding: 48px;'>                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                            </td>                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                        </tr>                                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                        <tr>                                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                            <td align='center' class='sm-px-24' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly;'>                                                                                                                                                                                                                                            ");
            sb.Append("                                <table style='width: 100%;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                          ");
            sb.Append("                                    <tr>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("                                        <td class='sm-px-24' style='border-top-right-radius: 20px; background-color: #ffffff; padding-top: 20px; padding-bottom: 20px; border-top-left-radius: 20px;'>                                                                                                                                                                                  ");
            sb.Append("                                            <div style='text-align:center;'>                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                <a href='" + linkSiteInstitucional + "' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly;'>                                                                                                                                                                                                                      ");
            sb.Append("                                                    <img src='" + linkLogoSindicato + "' width='150' alt='Sindpetshop-SP' style='max-width: 100%; vertical-align: middle; line-height: 100%; border: 0;'>                                                                                                                               ");
            sb.Append("                                                </a>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                            </div>                                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                        </td>                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                    </tr>                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                    <tr>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("                                        <td class='sm-px-24' style='mso-line-height-rule: exactly;  background-color: #ffffff;  padding: 0px 40px 40px 40px; text-align: left; line-height: 24px; color: #626262; border-bottom-right-radius: 20px;  border-bottom-left-radius: 20px;'>                                                                                               ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin-bottom: 0; font-size: 20px; font-weight: 600;'>                                                                                                                                                                                                        ");
            sb.Append("                                                Olá                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin-top: 0; font-size: 24px; font-weight: 700; color: #e58334;'>                                                                                                                                                                                           ");
            sb.Append(nomeUsuario);
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0; margin-bottom: 24px;'>                                                                                                                                                                                                                             ");
            sb.Append("                                                A sua solicitação de redefinição de senha foi atendida!                                                                                                                                                                                                                                                                                ");
            sb.Append("                                                <span style='font-weight: 600;'>                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                                    Sindpetshop-SP                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                </span> Conta -                                                                                                                                                                                                                                                                                                                           ");
            sb.Append("                                                <span style='font-weight: 600;'>                                                                                                                                                                                                                                                                                                          ");
            sb.Append(mailTo);
            sb.Append("                                                </span>                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("                                                do                                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                <span style='font-weight: 700; color: #e58334;'>                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                    SIS.Tech.                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                                </span>                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin-top: 0; font-size: 24px; font-weight: 700; color: #e58334;'>                                                                                                                                                                                           ");
            sb.Append("SUA SENHA É TEMPORÁRIA, favor entrar no sistema e alterar esta senha!");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <table align='center' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                    ");
            sb.Append("                                                <tr>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                                    <td style='font-size: 24px; font-weight: 700; color: #e58334; font-family: Montserrat, -apple-system, 'Segoe UI', sans-serif;'>                                                                                                                                                                                                     ");
            sb.Append(senhaCryptoNew);
            sb.Append("                                                    </td>                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                </tr>                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("                                            </table>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                            </br>                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                                            <table style='width: 100%;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                              ");
            sb.Append("                                                <tr>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                                    <td style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; padding-top: 32px; padding-bottom: 12px;'>                                                                                                                                                                                                           ");
            sb.Append("                                                        <div style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; height: 1px; background-color: #eceff1; line-height: 1px;'>&zwnj;</div>                                                                                                                                                                         ");
            sb.Append("                                                        </br>                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                                        <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0;'>                                                                                                                                                                                                                                      ");
            sb.Append("                                                            Caso tenha alguma dificuldade, solicite a nossa ajuda!                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                        </p>                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                        <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0;'>                                                                                                                                                                                                                                      ");
            sb.Append("                                                            Entre em contato conosco em                                                                                                                                                                                                                                                                                                   ");
            sb.Append("                                                            <a href=' " + emailSuporte + "' class='hover-underline' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; color: #000; text-decoration: none;'>                                                                                                                                    ");
            sb.Append("                                                                suporte@sindpetshop.org.com                                                                                                                                                                                                                                                                                               ");
            sb.Append("                                                            </a>                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                                        </p>                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                    </td>                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                </tr>                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("                                            </table>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                        </td>                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                    </tr>                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                </table>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("                            </td>                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                        </tr>                                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                    </table>                                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                </td>                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("            </tr>                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("        </table>                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("    </div>                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.Append("</br>");
            sb.Append("</br>");
            sb.Append("</body>                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("</html>                                                                                                                                                                                                                                                                                                                                                                                   ");


            body = sb.ToString();

            return body;

        }

        public string bodyLoginBloeqado(string mailFrom, string mailTo, string subject, string codForamtado, string nomeUsuario, string nomeLogin)
        {
            string body = string.Empty;

            var emailSuporte = new LocalMachine().LerParametro("SINDPETSHOP", "Configuracoes", "EmailSuporte").Valor;
            var linkSiteInstitucional = new LocalMachine().LerParametro("SINDPETSHOP", "Configuracoes", "LinkSiteInstitucional").Valor;
            var linkLogoSindicato = new LocalMachine().LerParametro("SINDPETSHOP", "Configuracoes", "LinkLogoSindicato").Valor;
            var linkTwoStepsCover = new LocalMachine().LerParametro("SINDPETSHOP", "ConfiguracaoRotas", "LinkTwoStepsCover").Valor;

            StringBuilder sb = new StringBuilder();

            sb.Append("<!DOCTYPE html>                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.Append("<html>                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.Append("<head>                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.Append("    <meta charset='utf-8'>                                                                                                                                                                                                                                                                                                                                                                ");
            sb.Append("    <title>Redefinir a sua senha</title>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("    <link href='https://fonts.googleapis.com/css?family=Montserrat:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700' rel='stylesheet' media='screen'>                                                                                                                                                                                        ");
            sb.Append("    <style>                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.Append("        .hover-underline:hover {                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("            text-decoration: underline !important;                                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("        @media (max-width: 600px) {                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("            .sm-w-full                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        {                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("            width: 100% !important;                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        .sm-px-24 {                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("            padding-left: 24px !important;                                                                                                                                                                                                                                                                                                                                                ");
            sb.Append("            padding-right: 24px !important;                                                                                                                                                                                                                                                                                                                                               ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        .sm-py-32 {                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("            padding-top: 32px !important;                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("            padding-bottom: 32px !important;                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("        }                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("        }</style>                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("</head>                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("<body style='margin: 0; width: 100%; padding: 0; word-break: break-word; -webkit-font-smoothing: antialiased; background-color: #eceff1;'>                                                                                                                                                                                                                                                ");
            sb.Append("    <div role='article' aria-roledescription='email' aria-label='Reset your Password' lang='en' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly;'>                                                                                                                                                                                                            ");
            sb.Append("        <table style='width: 100%; font-family: Montserrat, -apple-system, 'Segoe UI', sans-serif;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                  ");
            sb.Append("            <tr>                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                <td align='center' style='mso-line-height-rule: exactly; background-color: #eceff1; font-family: Montserrat, -apple-system, 'Segoe UI', sans-serif;'>                                                                                                                                                                                                                   ");
            sb.Append("                    <table class='sm-w-full' style='width: 600px;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                   ");
            sb.Append("                        <tr>                                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                            <td class='sm-py-32 sm-px-24' style='padding: 48px;'>                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                            </td>                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                        </tr>                                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                        <tr>                                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                            <td align='center' class='sm-px-24' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly;'>                                                                                                                                                                                                                                            ");
            sb.Append("                                <table style='width: 100%;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                          ");
            sb.Append("                                    <tr>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("                                        <td class='sm-px-24' style='border-top-right-radius: 20px; background-color: #ffffff; padding-top: 20px; padding-bottom: 20px; border-top-left-radius: 20px;'>                                                                                                                                                                                  ");
            sb.Append("                                            <div style='text-align:center;'>                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                <a href='" + linkSiteInstitucional + "' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly;'>                                                                                                                                                                                                                      ");
            sb.Append("                                                    <img src='" + linkLogoSindicato + "' width='150' alt='Sindpetshop-SP' style='max-width: 100%; vertical-align: middle; line-height: 100%; border: 0;'>                                                                                                                               ");
            sb.Append("                                                </a>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                            </div>                                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                        </td>                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                    </tr>                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                    <tr>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("                                        <td class='sm-px-24' style='mso-line-height-rule: exactly;  background-color: #ffffff;  padding: 0px 40px 40px 40px; text-align: left; line-height: 24px; color: #626262; border-bottom-right-radius: 20px;  border-bottom-left-radius: 20px;'>                                                                                               ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin-bottom: 0; font-size: 20px; font-weight: 600;'>                                                                                                                                                                                                        ");
            sb.Append("                                                Olá                                                                                                                                                                                                                                                                                                                                       ");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin-top: 0; font-size: 24px; font-weight: 700; color: #e58334;'>                                                                                                                                                                                           ");
            sb.Append(nomeUsuario);
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0; margin-bottom: 24px;'>                                                                                                                                                                                                                             ");
            sb.Append("                                                Registro inserido com Sucesso!                                                                                                                                                                                                                                                                                  ");
            sb.Append("                                                <span style='font-weight: 600;'>                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                                    Sindpetshop-SP                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                </span> Conta -                                                                                                                                                                                                                                                                                                                           ");
            sb.Append("                                                <span style='font-weight: 600;'>                                                                                                                                                                                                                                                                                                          ");
            sb.Append(mailTo);
            sb.Append("                                                </span>                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("                                                do                                                                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                <span style='font-weight: 700; color: #e58334;'>                                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                    SIS.Tech.                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                                </span>                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin-top: 0; font-size: 24px; font-weight: 700; color: #e58334;'>                                                                                                                                                                                           ");
            sb.Append("O seu login encontra-se BLOQUEADO! Favor solicitar o desbloqueio para o responsável!");
            sb.Append("                                            </p>                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                            <table align='center' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                                    ");
            sb.Append("                                                <tr>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                                    <td style='font-size: 24px; font-weight: 700; color: #e58334; font-family: Montserrat, -apple-system, 'Segoe UI', sans-serif;'>                                                                                                                                                                                                     ");
            sb.Append(nomeLogin);
            sb.Append("                                                    </td>                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                </tr>                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("                                            </table>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                            </br>                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                                            <table style='width: 100%;' cellpadding='0' cellspacing='0' role='presentation'>                                                                                                                                                                                                                                                              ");
            sb.Append("                                                <tr>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                                    <td style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; padding-top: 32px; padding-bottom: 12px;'>                                                                                                                                                                                                           ");
            sb.Append("                                                        <div style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; height: 1px; background-color: #eceff1; line-height: 1px;'>&zwnj;</div>                                                                                                                                                                         ");
            sb.Append("                                                        </br>                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                                        <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0;'>                                                                                                                                                                                                                                      ");
            sb.Append("                                                            Caso tenha alguma dificuldade, solicite a nossa ajuda!                                                                                                                                                                                                                                                                        ");
            sb.Append("                                                        </p>                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                        <p style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; margin: 0;'>                                                                                                                                                                                                                                      ");
            sb.Append("                                                            Entre em contato conosco em                                                                                                                                                                                                                                                                                                   ");
            sb.Append("                                                            <a href=' " + emailSuporte + "' class='hover-underline' style='font-family: 'Montserrat', sans-serif; mso-line-height-rule: exactly; color: #000; text-decoration: none;'>                                                                                                                                    ");
            sb.Append("                                                                suporte@sindpetshop.org.com                                                                                                                                                                                                                                                                                               ");
            sb.Append("                                                            </a>                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("                                                        </p>                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                                                    </td>                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                                </tr>                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("                                            </table>                                                                                                                                                                                                                                                                                                                                      ");
            sb.Append("                                        </td>                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                                    </tr>                                                                                                                                                                                                                                                                                                                                                 ");
            sb.Append("                                </table>                                                                                                                                                                                                                                                                                                                                                  ");
            sb.Append("                            </td>                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("                        </tr>                                                                                                                                                                                                                                                                                                                                                             ");
            sb.Append("                    </table>                                                                                                                                                                                                                                                                                                                                                              ");
            sb.Append("                </td>                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.Append("            </tr>                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.Append("        </table>                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.Append("    </div>                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.Append("</br>");
            sb.Append("</br>");
            sb.Append("</body>                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.Append("</html>                                                                                                                                                                                                                                                                                                                                                                                   ");


            body = sb.ToString();

            return body;

        }

    }
}
